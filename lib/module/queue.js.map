{"version":3,"names":["ToastQueue","queue","activeToasts","Map","groupToasts","isProcessing","constructor","config","maxConcurrent","maxQueueSize","groupDeduplication","queueTimeout","eventHandler","onQueueEvent","startCleanupTimer","getQueue","enqueue","toast","length","lowestPriorityIndex","findLowestPriorityIndex","removed","splice","removeFromGroup","emitEvent","group","existing","findInGroup","message","updateToast","id","preventDuplicate","duplicate","findDuplicate","expiresAt","Date","now","priority","insertIndex","findInsertIndex","updateQueuePositions","addToGroup","dequeue","size","undefined","shift","addActive","set","removeActive","get","delete","getActive","getAllActive","Array","from","values","activeMatch","find","t","groupToastIds","findByGroup","results","push","clearGroup","toasts","forEach","filter","clear","hasCapacity","activeSize","setProcessing","value","processing","getStats","stats","total","active","pending","byPriority","byGroup","allToasts","timestamps","map","timestamp","oldestTimestamp","Math","min","newestTimestamp","max","updates","activeToast","Object","assign","queueIndex","findIndex","index","lowestPriority","lowestIndex","i","queuePosition","has","Set","add","groupSet","type","event","cleanupTimer","setInterval","cleanupExpiredToasts","expiredIndexes","reverse","expired","destroy","clearInterval"],"sourceRoot":"../../src","sources":["queue.ts"],"mappings":"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","ignoreList":[]}
